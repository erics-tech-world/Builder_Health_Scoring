        function editLastBuilder() {
            if (builderResults.length === 0) {
                alert('No builders to edit');
                return;
            }

            const lastBuilder = builderResults[builderResults.length - 1];
            editBuilder(lastBuilder.name);
        }<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Builder Scoring Tool</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .rubric-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            font-size: 12px;
        }
        .rubric-table th,
        .rubric-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .rubric-table th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }
        .category-col {
            text-align: left !important;
            font-weight: bold;
            background-color: #f9f9f9;
            max-width: 200px;
        }
        .weight-col {
            background-color: #e3f2fd;
            font-weight: bold;
        }
        .score-5 { background-color: #4CAF50; color: white; }
        .score-4 { background-color: #8BC34A; }
        .score-3 { background-color: #FFC107; }
        .score-2 { background-color: #FF9800; }
        .score-1 { background-color: #F44336; color: white; }
        
        .calculator {
            background-color: #f0f8ff;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }
        .calculator h3 {
            color: #333;
            margin-top: 0;
        }
        .builder-name-input {
            margin-bottom: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 6px;
            border: 2px solid #2196F3;
        }
        .builder-name-input label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 16px;
            color: #333;
        }
        .builder-name-input input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .calc-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }
        .calc-row label {
            width: 300px;
            font-size: 12px;
        }
        .calc-row select {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .calc-row .points {
            font-weight: bold;
            color: #333;
            min-width: 60px;
        }
        .total-score {
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .button-row {
            text-align: center;
            margin-top: 15px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            margin: 0 5px;
        }
        .btn-primary {
            background-color: #2196F3;
            color: white;
        }
        .btn-secondary {
            background-color: #FF9800;
            color: white;
        }
        .btn-success {
            background-color: #4CAF50;
            color: white;
        }
        .btn-danger {
            background-color: #F44336;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        
        .results-section {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            border: 2px solid #4CAF50;
            display: none;
        }
        .results-section h3 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .builder-result {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .builder-name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .builder-score {
            font-size: 24px;
            font-weight: bold;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 10px;
        }
        .score-excellent { background-color: #4CAF50; color: white; }
        .score-good { background-color: #8BC34A; color: white; }
        .score-average { background-color: #FFC107; color: black; }
        .score-below-average { background-color: #FF9800; color: white; }
        .score-poor { background-color: #F44336; color: white; }
        .score-details {
            font-size: 12px;
            color: #666;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        .rating-scale {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3e0;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CBUSA Builder Evaluation Rubric</h1>
        
        <table class="rubric-table">
            <thead>
                <tr>
                    <th class="category-col">Category</th>
                    <th class="score-5">5 (Excellent)</th>
                    <th class="score-4">4 (Good)</th>
                    <th class="score-3">3 (Average)</th>
                    <th class="score-2">2 (Below Average)</th>
                    <th class="score-1">1 (Poor)</th>
                    <th class="weight-col">Weight</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="category-col">National contracts enrolled</td>
                    <td class="score-5">>10</td>
                    <td class="score-4">8-10</td>
                    <td class="score-3">5-7</td>
                    <td class="score-2">4-3</td>
                    <td class="score-1">3-1</td>
                    <td class="weight-col">9</td>
                </tr>
                <tr>
                    <td class="category-col">National contracts reported (avg last 4 quarters)</td>
                    <td class="score-5">>8</td>
                    <td class="score-4">8-6</td>
                    <td class="score-3">5-4</td>
                    <td class="score-2">4-3</td>
                    <td class="score-1">3-1</td>
                    <td class="weight-col">9</td>
                </tr>
                <tr>
                    <td class="category-col"># of local vendors used (last 4 quarters)</td>
                    <td class="score-5">>12</td>
                    <td class="score-4">11-10</td>
                    <td class="score-3">9-7</td>
                    <td class="score-2">6-4</td>
                    <td class="score-1">3-1</td>
                    <td class="weight-col">7</td>
                </tr>
                <tr>
                    <td class="category-col">% of annual revenue made in rebates</td>
                    <td class="score-5">>2%</td>
                    <td class="score-4">1-2%</td>
                    <td class="score-3">0.5-1%</td>
                    <td class="score-2">0.1-0.5%</td>
                    <td class="score-1">0-0.1%</td>
                    <td class="weight-col">9</td>
                </tr>
                <tr>
                    <td class="category-col">% of events attended</td>
                    <td class="score-5">100%</td>
                    <td class="score-4">75-99%</td>
                    <td class="score-3">50-75%</td>
                    <td class="score-2">25-50%</td>
                    <td class="score-1">0-25%</td>
                    <td class="weight-col">9</td>
                </tr>
                <tr>
                    <td class="category-col">% of GM meetings attended</td>
                    <td class="score-5">100%</td>
                    <td class="score-4">76-99%</td>
                    <td class="score-3">51-75%</td>
                    <td class="score-2">26-50%</td>
                    <td class="score-1">0-25%</td>
                    <td class="weight-col">9</td>
                </tr>
                <tr>
                    <td class="category-col">Payment discrepancies (past 12 months)</td>
                    <td class="score-5">0 late payments</td>
                    <td class="score-4">1 late payment</td>
                    <td class="score-3">2-3 late payments</td>
                    <td class="score-2">4-5 late payments</td>
                    <td class="score-1">>5 late payments</td>
                    <td class="weight-col">10</td>
                </tr>
                <tr>
                    <td class="category-col">Builder Reporting?</td>
                    <td class="score-5">Yes</td>
                    <td class="score-4">-</td>
                    <td class="score-3">-</td>
                    <td class="score-2">-</td>
                    <td class="score-1">No</td>
                    <td class="weight-col">6</td>
                </tr>
                <tr>
                    <td class="category-col"># of homes built annually</td>
                    <td class="score-5">>20</td>
                    <td class="score-4">19-8</td>
                    <td class="score-3">7-4</td>
                    <td class="score-2">3-1</td>
                    <td class="score-1">0</td>
                    <td class="weight-col">6</td>
                </tr>
                <tr>
                    <td class="category-col">Average $ of each project</td>
                    <td class="score-5">>$1.5M</td>
                    <td class="score-4">$750K-$1.5M</td>
                    <td class="score-3">$400K-$750K</td>
                    <td class="score-2">$100K-$400K</td>
                    <td class="score-1">$0-$100K</td>
                    <td class="weight-col">6</td>
                </tr>
                <tr>
                    <td class="category-col">Total annual revenue</td>
                    <td class="score-5">>$30M</td>
                    <td class="score-4">-</td>
                    <td class="score-3">-</td>
                    <td class="score-2">-</td>
                    <td class="score-1"><$30M</td>
                    <td class="weight-col">6</td>
                </tr>
                <tr>
                    <td class="category-col">% of committed buys participated</td>
                    <td class="score-5">100%</td>
                    <td class="score-4">75%</td>
                    <td class="score-3">50%</td>
                    <td class="score-2">25%</td>
                    <td class="score-1">0%</td>
                    <td class="weight-col">7</td>
                </tr>
                <tr>
                    <td class="category-col">Total Rebates</td>
                    <td class="score-5">>25</td>
                    <td class="score-4">25-11</td>
                    <td class="score-3">10-1</td>
                    <td class="score-2">0</td>
                    <td class="score-1"><0</td>
                    <td class="weight-col">7</td>
                </tr>
            </tbody>
        </table>

        <div class="calculator">
            <h3>Score Calculator</h3>
            
            <div class="builder-name-input">
                <label for="builder-name">Builder Name:</label>
                <input type="text" id="builder-name" placeholder="Enter builder name (e.g., ABC Construction)">
            </div>
            
            <div id="calculator-rows"></div>
            
            <div class="total-score" id="total-score">
                Total Score: 0 / 500
            </div>
            
            <div class="button-row">
                <button class="btn btn-primary" onclick="submitBuilder()">
                    📊 Submit Builder Score
                </button>
                <button class="btn btn-secondary" onclick="clearForm()">
                    🔄 Clear Form
                </button>
            </div>
        </div>

        <div class="results-section" id="results-section">
            <h3>🏆 Builder Scores Summary</h3>
            <div id="builder-list"></div>
            <div class="button-row">
                <button class="btn btn-success" onclick="exportResults()">
                    📥 Export to CSV
                </button>
                <button class="btn btn-danger" onclick="clearAllResults()">
                    🗑️ Clear All Results
                </button>
            </div>
        </div>

        <div class="rating-scale">
            <h3>Rating Scale</h3>
            <p><strong>Total Possible Points:</strong> 500</p>
            <p><strong>Scoring Ranges:</strong></p>
            <ul>
                <li><strong>400-500:</strong> Excellent Partnership</li>
                <li><strong>350-399:</strong> Good Partnership</li>
                <li><strong>300-349:</strong> Average Partnership</li>
                <li><strong>200-299:</strong> Below Average Partnership</li>
                <li><strong>100-199:</strong> Poor Partnership</li>
            </ul>
        </div>
    </div>

    <script>
        const categories = [
            {name: "National contracts enrolled", weight: 9},
            {name: "National contracts reported (avg last 4 quarters)", weight: 9},
            {name: "# of local vendors used (last 4 quarters)", weight: 7},
            {name: "% of annual revenue made in rebates", weight: 9},
            {name: "% of events attended", weight: 9},
            {name: "% of GM meetings attended", weight: 9},
            {name: "Payment discrepancies (past 12 months)", weight: 10},
            {name: "Builder Reporting?", weight: 6},
            {name: "# of homes built annually", weight: 6},
            {name: "Average $ of each project", weight: 6},
            {name: "Total annual revenue", weight: 6},
            {name: "% of committed buys participated", weight: 7},
            {name: "Total Rebates", weight: 7}
        ];

        let builderResults = [];

        function createCalculator() {
            const container = document.getElementById('calculator-rows');
            container.innerHTML = '';
            
            const criteria = {
                "National contracts enrolled": ["3-1", "4-3", "5-7", "8-10", ">10"],
                "National contracts reported (avg last 4 quarters)": ["3-1", "4-3", "5-4", "8-6", ">8"],
                "# of local vendors used (last 4 quarters)": ["3-1", "6-4", "9-7", "11-10", ">12"],
                "% of annual revenue made in rebates": ["0-0.1%", "0.1-0.5%", "0.5-1%", "1-2%", ">2%"],
                "% of events attended": ["0-25%", "25-50%", "50-75%", "75-99%", "100%"],
                "% of GM meetings attended": ["0-25%", "26-50%", "51-75%", "76-99%", "100%"],
                "Payment discrepancies (past 12 months)": [">5 late payments", "4-5 late payments", "2-3 late payments", "1 late payment", "0 late payments"],
                "Builder Reporting?": ["No", "-", "-", "-", "Yes"],
                "# of homes built annually": ["0", "3-1", "7-4", "19-8", ">20"],
                "Average $ of each project": ["$0-$100K", "$100K-$400K", "$400K-$750K", "$750K-$1.5M", ">$1.5M"],
                "Total annual revenue": ["<$30M", "-", "-", "-", ">$30M"],
                "% of committed buys participated": ["0%", "25%", "50%", "75%", "100%"],
                "Total Rebates": ["<0", "0", "10-1", "25-11", ">25"]
            };
            
            categories.forEach((category, index) => {
                const row = document.createElement('div');
                row.className = 'calc-row';
                row.style.marginBottom = '15px';
                row.style.padding = '10px';
                row.style.backgroundColor = 'white';
                row.style.borderRadius = '6px';
                row.style.border = '1px solid #ddd';
                
                const categoryName = category.name;
                const categoryWeight = category.weight;
                const scoreCriteria = criteria[categoryName] || [];
                
                row.innerHTML = `
                    <div style="width: 100%; margin-bottom: 8px;">
                        <label style="font-weight: bold; color: #333; display: block; margin-bottom: 5px;">
                            ${categoryName} (Weight: ${categoryWeight})
                        </label>
                        <div style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                            <select id="score-${index}" onchange="calculateTotal()" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; min-width: 200px;">
                                <option value="0">Select Score...</option>
                                <option value="1">1 - ${scoreCriteria[0] || 'Poor'}</option>
                                <option value="2">2 - ${scoreCriteria[1] || 'Below Average'}</option>
                                <option value="3">3 - ${scoreCriteria[2] || 'Average'}</option>
                                <option value="4">4 - ${scoreCriteria[3] || 'Good'}</option>
                                <option value="5">5 - ${scoreCriteria[4] || 'Excellent'}</option>
                            </select>
                            <span class="points" id="points-${index}" style="font-weight: bold; color: #333; min-width: 60px;">0 pts</span>
                        </div>
                    </div>
                `;
                container.appendChild(row);
            });
        }

        function calculateTotal() {
            let total = 0;
            categories.forEach((category, index) => {
                const scoreSelect = document.getElementById(`score-${index}`);
                const pointsSpan = document.getElementById(`points-${index}`);
                
                const score = parseInt(scoreSelect.value) || 0;
                const points = score * category.weight;
                total += points;
                
                pointsSpan.textContent = `${points} pts`;
            });
            
            document.getElementById('total-score').textContent = `Total Score: ${total} / 500`;
            return total;
        }

        function submitBuilder() {
            const builderName = document.getElementById('builder-name').value.trim();
            if (!builderName) {
                alert('Please enter a builder name');
                return;
            }

            const total = calculateTotal();
            if (total === 0) {
                alert('Please select scores for all categories');
                return;
            }

            // Check if builder already exists
            const existingBuilder = builderResults.find(b => b.name.toLowerCase() === builderName.toLowerCase());
            if (existingBuilder) {
                if (!confirm(`Builder "${builderName}" already exists. Do you want to update their score?`)) {
                    return;
                }
                // Remove existing entry
                builderResults = builderResults.filter(b => b.name.toLowerCase() !== builderName.toLowerCase());
            }

            // Collect individual scores
            const scores = {};
            categories.forEach((category, index) => {
                const scoreSelect = document.getElementById(`score-${index}`);
                scores[category.name] = parseInt(scoreSelect.value) || 0;
            });

            // Add to results
            const builderResult = {
                name: builderName,
                total: total,
                scores: scores,
                timestamp: new Date()
            };

            builderResults.push(builderResult);
            displayResults();
            clearForm();
            
            // Show edit button for last submitted builder
            document.getElementById('edit-last-btn').style.display = 'inline-block';
            
            // Show success message
            alert(`✅ ${builderName} scored and added to results!`);
        }

        function editLastBuilder() {
            if (builderResults.length === 0) {
                alert('No builders to edit');
                return;
            }

            const lastBuilder = builderResults[builderResults.length - 1];
            
            // Fill form with last builder's data
            document.getElementById('builder-name').value = lastBuilder.name;
            
            categories.forEach((category, index) => {
                const scoreSelect = document.getElementById(`score-${index}`);
                scoreSelect.value = lastBuilder.scores[category.name];
            });
            
            // Remove the last builder from results (they can re-submit)
            builderResults.pop();
            
            // Update display
            if (builderResults.length === 0) {
                document.getElementById('results-section').style.display = 'none';
                document.getElementById('edit-last-btn').style.display = 'none';
            } else {
                displayResults();
            }
            
            // Recalculate totals
            calculateTotal();
            
            alert(`✏️ ${lastBuilder.name} loaded for editing. Make changes and submit again.`);
        }

        function clearForm() {
            document.getElementById('builder-name').value = '';
            categories.forEach((category, index) => {
                document.getElementById(`score-${index}`).value = 0;
                document.getElementById(`points-${index}`).textContent = '0 pts';
            });
            document.getElementById('total-score').textContent = 'Total Score: 0 / 500';
        }

        function displayResults() {
            const resultsSection = document.getElementById('results-section');
            const builderList = document.getElementById('builder-list');
            
            resultsSection.style.display = 'block';
            
            // Sort by score (highest first)
            const sortedResults = [...builderResults].sort((a, b) => b.total - a.total);
            
            builderList.innerHTML = sortedResults.map((result, index) => {
                const scoreClass = getScoreClass(result.total);
                const rank = index + 1;
                const medal = rank === 1 ? '🥇' : rank === 2 ? '🥈' : rank === 3 ? '🥉' : `#${rank}`;
                
                return `
                    <div class="builder-result">
                        <div class="builder-name">${medal} ${result.name}</div>
                        <div class="builder-score ${scoreClass}">${result.total} / 500 points</div>
                        <div class="score-details">
                            <div><strong>Payment discrepancies:</strong> ${result.scores['Payment discrepancies (past 12 months)']} × 10 = ${result.scores['Payment discrepancies (past 12 months)'] * 10} pts</div>
                            <div><strong>Events attended:</strong> ${result.scores['% of events attended']} × 9 = ${result.scores['% of events attended'] * 9} pts</div>
                            <div><strong>GM meetings:</strong> ${result.scores['% of GM meetings attended']} × 9 = ${result.scores['% of GM meetings attended'] * 9} pts</div>
                            <div><strong>National contracts:</strong> ${result.scores['National contracts enrolled']} × 9 = ${result.scores['National contracts enrolled'] * 9} pts</div>
                            <div><strong>Rebate revenue %:</strong> ${result.scores['% of annual revenue made in rebates']} × 9 = ${result.scores['% of annual revenue made in rebates'] * 9} pts</div>
                            <div><strong>Contract reporting:</strong> ${result.scores['National contracts reported (avg last 4 quarters)']} × 9 = ${result.scores['National contracts reported (avg last 4 quarters)'] * 9} pts</div>
                        </div>
                        <button onclick="removeBuilder('${result.name}')" class="btn btn-danger" style="margin-top: 10px; font-size: 12px; padding: 5px 10px;">
                            Remove
                        </button>
                    </div>
                `;
            }).join('');
        }

        function getScoreClass(score) {
            if (score >= 400) return 'score-excellent';
            if (score >= 350) return 'score-good';
            if (score >= 300) return 'score-average';
            if (score >= 200) return 'score-below-average';
            return 'score-poor';
        }

        function removeBuilder(builderName) {
            if (confirm(`Are you sure you want to remove ${builderName}?`)) {
                builderResults = builderResults.filter(b => b.name !== builderName);
                if (builderResults.length === 0) {
                    document.getElementById('results-section').style.display = 'none';
                } else {
                    displayResults();
                }
            }
        }

        function clearAllResults() {
            if (confirm('Are you sure you want to clear all results? This cannot be undone.')) {
                builderResults = [];
                document.getElementById('results-section').style.display = 'none';
            }
        }

        function exportResults() {
            if (builderResults.length === 0) {
                alert('No results to export');
                return;
            }

            let csv = 'Rank,Builder Name,Total Score,';
            csv += categories.map(cat => `"${cat.name}"`).join(',') + ',';
            csv += categories.map(cat => `"${cat.name} Points"`).join(',') + '\n';

            const sortedResults = [...builderResults].sort((a, b) => b.total - a.total);
            
            sortedResults.forEach((result, index) => {
                csv += `${index + 1},"${result.name}",${result.total},`;
                csv += categories.map(cat => result.scores[cat.name]).join(',') + ',';
                csv += categories.map(cat => result.scores[cat.name] * cat.weight).join(',') + '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `builder_scores_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize calculator when page loads
        document.addEventListener('DOMContentLoaded', function() {
            createCalculator();
        });
    </script>
</body>
</html>
